#!/usr/bin/make

# Tensor VM - Makefile

all:				tensor.exe

tensor.exe:				obj/main_win.o	obj/bios_win.o	obj/x86_cpu_win.o	obj/x86_mem_win.o	obj/interrupt_win.o	obj/instr_set_win.o	obj/monitor_win.o	obj/vmfloppy_win.o	obj/virtual_machine_win.o
	cd obj && x86_64-w64-mingw32-gcc main_win.o bios_win.o x86_cpu_win.o x86_mem_win.o interrupt_win.o monitor_win.o vmfloppy_win.o virtual_machine_win.o instr_set_win.o -o ../bin/tensor.exe && echo "Build Successfully."

obj/main_win.o:			src/main.c	src/log.h	src/helpinfo.c
	x86_64-w64-mingw32-gcc -c -std=gnu23 -Wall src/main.c				-o obj/main_win.o

obj/bios_win.o:			src/bios/bios.c	src/bios/bios.h
	x86_64-w64-mingw32-gcc -c -std=gnu23 -Wall src/bios/bios.c			-o obj/bios_win.o

obj/x86_cpu_win.o:		src/cpu/x86_cpu.c	src/cpu/x86_cpu.h
	x86_64-w64-mingw32-gcc -c -std=gnu23 -Wall src/cpu/x86_cpu.c		-o obj/x86_cpu_win.o

obj/x86_mem_win.o:		src/memory/x86_mem.c	src/memory/x86_mem.h
	x86_64-w64-mingw32-gcc -c -std=gnu23 -Wall src/memory/x86_mem.c		-o obj/x86_mem_win.o

obj/interrupt_win.o:	src/cpu/interrupt.c		src/cpu/interrupt.h
	x86_64-w64-mingw32-gcc -c -std=gnu23 -Wall src/cpu/interrupt.c		-o obj/interrupt_win.o

obj/instr_set_win.o:	src/cpu/instr_set.c	src/cpu/instr_set.h
	x86_64-w64-mingw32-gcc -c -std=gnu23 -Wall src/cpu/instr_set.c		-o obj/instr_set_win.o

obj/monitor_win.o:		src/monitor/monitor.c	src/monitor/monitor.h	src/monitor/display_core.c	src/monitor/display_core.h
	x86_64-w64-mingw32-gcc -c -std=gnu23 -Wall src/monitor/monitor.c	-o obj/monitor_win.o

obj/vmfloppy_win.o:		src/vmdisk/vmfloppy.c	src/vmdisk/vmfloppy.h
	x86_64-w64-mingw32-gcc -c -std=gnu23 -Wall src/vmdisk/vmfloppy.c	-o obj/vmfloppy_win.o

obj/virtual_machine_win.o:	src/virtual_machine.c	src/virtual_machine.h
	x86_64-w64-mingw32-gcc -c -std=gnu23 -Wall src/virtual_machine.c	-o obj/virtual_machine_win.o

clean:
	rm -f obj/*
	rm -f bin/*

install:
	bin/tensor -
